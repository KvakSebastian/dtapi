(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{d1Qp:function(t,a,e){"use strict";e.r(a),e.d(a,"GroupsModule",function(){return J});var i=e("tyNb"),c=e("ofXK"),n=e("UKGz"),r=e("M9IT"),o=e("+0xr"),s=e("Dh3D"),l=e("cp0P"),u=e("L0I5"),p=e("0IaG"),d=e("3Pt+"),m=e("fXoL"),b=e("AytR"),h=e("tk/3"),f=e("dNgK");let g=(()=>{class t{constructor(t,a){this.http=t,this.snackBar=a,this.sharingData=[]}saveData(t){this.sharingData.push(t)}getsharedData(){return this.sharingData}logIn(){return this.http.post(b.a.BASEURL+"/Login/index",{username:"admin",password:"dtapi_admin"})}getData(t,a){return this.http.get(`${b.a.BASEURL}${t}/getRecords/${a||""}`)}delData(t,a){return this.http.get(`${b.a.BASEURL}${t}/del/${a||""}`)}insertData(t,a){return this.http.post(`${b.a.BASEURL}${t}/insertData`,a)}updateData(t,a,e){return this.http.post(`${b.a.BASEURL}${t}/update/${a}`,e)}snackBarOpen(t){return this.snackBar.open(t,"",{duration:1500})}}return t.\u0275fac=function(a){return new(a||t)(m.Yb(h.a),m.Yb(f.a))},t.\u0275prov=m.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var _=e("kmnG"),y=e("qFsG"),S=e("d3UM"),D=e("bTqV"),v=e("FKr1");function T(t,a){1&t&&(m.Ub(0,"mat-error",11),m.Fc(1,"\u0426\u0435 \u043f\u043e\u043b\u0435 \u0454 \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0438\u043c"),m.Tb())}function C(t,a){if(1&t&&(m.Ub(0,"mat-option",12),m.Fc(1),m.Tb()),2&t){const t=a.$implicit;m.lc("value",t.speciality_name),m.Cb(1),m.Gc(t.speciality_name)}}function U(t,a){1&t&&(m.Ub(0,"mat-error",11),m.Fc(1,"\u0426\u0435 \u043f\u043e\u043b\u0435 \u0454 \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0438\u043c"),m.Tb())}function F(t,a){if(1&t&&(m.Ub(0,"mat-option",12),m.Fc(1),m.Tb()),2&t){const t=a.$implicit;m.lc("value",t.faculty_name),m.Cb(1),m.Gc(t.faculty_name)}}function w(t,a){1&t&&(m.Ub(0,"mat-error",11),m.Fc(1,"\u0426\u0435 \u043f\u043e\u043b\u0435 \u0454 \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0438\u043c"),m.Tb())}let O=(()=>{class t{constructor(t,a,e,i){this.formBuilder=t,this.groupsSertvice=a,this.dialogRef=e,this.data=i,this.sharedInfo=[]}ngOnInit(){this.title="add"===this.data.type?"\u0414\u043e\u0434\u0430\u0442\u0438 \u0433\u0440\u0443\u043f\u0443":"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0433\u0440\u0443\u043f\u0443",this.sharedInfo=this.groupsSertvice.getsharedData(),this.specialities=this.sharedInfo[0][0],this.faculties=this.sharedInfo[0][1],this.groupsSertvice.getData("Group",this.data.group_id),this.form=this.formBuilder.group({group_name:[this.data?this.data.group_name:"",[d.w.required,d.w.pattern("[\u0410-\u042f\u0406]{1,4}[\u043c\u0437]?-[0-9]{2}-[0-9]{1}[\u043a]?")]],speciality_name:[this.data?this.data.speciality_name:"",[d.w.required]],faculty_name:[this.data?this.data.faculty_name:"",[d.w.required]]})}addGroup(){this.dialogRef.close(this.form.value)}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(a){return new(a||t)(m.Ob(d.e),m.Ob(g),m.Ob(p.g),m.Ob(p.a))},t.\u0275cmp=m.Ib({type:t,selectors:[["app-group-dialog"]],decls:26,vars:8,consts:[[3,"formGroup","ngSubmit"],["mat-dialog-title",""],["mat-dialog-content",""],["matInput","","formControlName","group_name"],["class","validation",4,"ngIf"],["formControlName","speciality_name"],[3,"value",4,"ngFor","ngForOf"],["formControlName","faculty_name"],["mat-dialog-actions",""],["mat-button","","type","button",3,"click"],["mat-button","","type","submit",3,"disabled"],[1,"validation"],[3,"value"]],template:function(t,a){1&t&&(m.Ub(0,"form",0),m.cc("ngSubmit",function(){return a.addGroup()}),m.Ub(1,"h1",1),m.Fc(2),m.Tb(),m.Ub(3,"div",2),m.Ub(4,"mat-form-field"),m.Ub(5,"mat-label"),m.Fc(6,"Group name"),m.Tb(),m.Pb(7,"input",3),m.Dc(8,T,2,0,"mat-error",4),m.Tb(),m.Ub(9,"mat-form-field"),m.Ub(10,"mat-label"),m.Fc(11,"Speciality name"),m.Tb(),m.Ub(12,"mat-select",5),m.Dc(13,C,2,2,"mat-option",6),m.Tb(),m.Dc(14,U,2,0,"mat-error",4),m.Tb(),m.Ub(15,"mat-form-field"),m.Ub(16,"mat-label"),m.Fc(17,"Faculty name"),m.Tb(),m.Ub(18,"mat-select",7),m.Dc(19,F,2,2,"mat-option",6),m.Tb(),m.Dc(20,w,2,0,"mat-error",4),m.Tb(),m.Tb(),m.Ub(21,"div",8),m.Ub(22,"button",9),m.cc("click",function(){return a.onNoClick()}),m.Fc(23," \u0412\u0456\u0434\u043c\u0456\u043d\u0438\u0442\u0438 "),m.Tb(),m.Ub(24,"button",10),m.Fc(25,"\u041e\u043a"),m.Tb(),m.Tb(),m.Tb()),2&t&&(m.lc("formGroup",a.form),m.Cb(2),m.Gc(a.title),m.Cb(6),m.lc("ngIf",a.form.get("group_name").invalid&&a.form.get("group_name").touched),m.Cb(5),m.lc("ngForOf",a.specialities),m.Cb(1),m.lc("ngIf",a.form.get("speciality_name").invalid&&a.form.get("speciality_name").touched),m.Cb(5),m.lc("ngForOf",a.faculties),m.Cb(1),m.lc("ngIf",a.form.get("faculty_name").invalid&&a.form.get("faculty_name").touched),m.Cb(4),m.lc("disabled",a.form.invalid))},directives:[d.x,d.q,d.i,p.h,p.e,_.c,_.g,y.b,d.c,d.p,d.g,c.k,S.a,c.j,p.c,D.b,_.b,v.m],styles:[".validation[_ngcontent-%COMP%]{color:red;font-size:.75rem}"]}),t})();var G=e("NFeN"),k=e("Qu3c"),P=e("668k");function I(t,a){1&t&&(m.Ub(0,"th",27),m.Fc(1,"No."),m.Tb())}function R(t,a){if(1&t&&(m.Ub(0,"td",28),m.Fc(1),m.Tb()),2&t){const t=a.$implicit;m.Cb(1),m.Hc(" ",t.group_id," ")}}function $(t,a){1&t&&(m.Ub(0,"th",27),m.Fc(1," \u0428\u0438\u0444\u0440 \u0433\u0440\u0443\u043f\u0438 "),m.Tb())}function B(t,a){if(1&t&&(m.Ub(0,"td",28),m.Fc(1),m.Tb()),2&t){const t=a.$implicit;m.Cb(1),m.Hc(" ",t.group_name," ")}}function M(t,a){1&t&&(m.Ub(0,"th",27),m.Fc(1,"\u0424\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442"),m.Tb())}function x(t,a){if(1&t&&(m.Ub(0,"td",28),m.Fc(1),m.Tb()),2&t){const t=a.$implicit;m.Cb(1),m.Hc(" ",t.faculty_name," ")}}function L(t,a){1&t&&(m.Ub(0,"th",27),m.Fc(1," C\u043f\u0435\u0446\u0456\u0430\u043b\u044c\u043d\u0456\u0441\u0442\u044c "),m.Tb())}function N(t,a){if(1&t&&(m.Ub(0,"td",28),m.Fc(1),m.Tb()),2&t){const t=a.$implicit;m.Cb(1),m.Hc(" ",t.speciality_name," ")}}function j(t,a){1&t&&(m.Ub(0,"th",29),m.Fc(1,"\u0414\u0456\u0457"),m.Tb())}function z(t,a){if(1&t){const t=m.Vb();m.Ub(0,"td",28),m.Ub(1,"button",30),m.cc("click",function(){m.vc(t);const e=a.$implicit;return m.gc(2).goToStudents(e.group_id,e.group_name)}),m.Ub(2,"mat-icon",31),m.Fc(3,"supervisor_account"),m.Tb(),m.Tb(),m.Ub(4,"button",30),m.cc("click",function(){m.vc(t);const e=a.$implicit;return m.gc(2).changeGroup(e)}),m.Ub(5,"mat-icon",32),m.Fc(6,"edit"),m.Tb(),m.Tb(),m.Ub(7,"button",30),m.cc("click",function(){m.vc(t);const e=a.$implicit;return m.gc(2).delCurrGroup(e)}),m.Ub(8,"mat-icon",33),m.Fc(9,"delete"),m.Tb(),m.Tb(),m.Tb()}}function H(t,a){1&t&&m.Pb(0,"tr",34)}function E(t,a){1&t&&m.Pb(0,"tr",35)}function A(t,a){if(1&t&&(m.Ub(0,"tr",36),m.Ub(1,"td",37),m.Fc(2),m.Tb(),m.Tb()),2&t){m.gc(2);const t=m.sc(15);m.Cb(2),m.Hc(' \u041d\u0456\u0447\u043e\u0433\u043e \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0437\u0430 \u0437\u0430\u0434\u0430\u043d\u0438\u043c \u0444\u0456\u043b\u044c\u0442\u0440\u043e\u043c "',t.value,'" ')}}const K=function(){return[5,10,15,20,25]};function q(t,a){if(1&t&&(m.Ub(0,"div",12),m.Ub(1,"table",13,14),m.Sb(3,15),m.Dc(4,I,2,0,"th",16),m.Dc(5,R,2,1,"td",17),m.Rb(),m.Sb(6,18),m.Dc(7,$,2,0,"th",16),m.Dc(8,B,2,1,"td",17),m.Rb(),m.Sb(9,19),m.Dc(10,M,2,0,"th",16),m.Dc(11,x,2,1,"td",17),m.Rb(),m.Sb(12,20),m.Dc(13,L,2,0,"th",16),m.Dc(14,N,2,1,"td",17),m.Rb(),m.Sb(15,21),m.Dc(16,j,2,0,"th",22),m.Dc(17,z,10,0,"td",17),m.Rb(),m.Dc(18,H,1,0,"tr",23),m.Dc(19,E,1,0,"tr",24),m.Dc(20,A,3,1,"tr",25),m.Tb(),m.Pb(21,"mat-paginator",26),m.Tb()),2&t){const t=m.gc();m.Cb(1),m.lc("dataSource",t.dataSource),m.Cb(17),m.lc("matHeaderRowDef",t.displayedColumns),m.Cb(1),m.lc("matRowDefColumns",t.displayedColumns),m.Cb(2),m.lc("pageSizeOptions",m.oc(4,K))}}function Q(t,a){1&t&&m.Pb(0,"app-loader")}const V=[{path:"",component:(()=>{class t{constructor(t,a,e){this.groupsSertvice=t,this.dialog=a,this.router=e,this.sharedData=[],this.displayedColumns=["group_id","group_name","speciality_name","faculty_name","actions"],this.dataSource=new o.l(void 0),this.res=[]}ngOnInit(){this.loading=!0,this.getGroups()}ngAfterViewInit(){this.paginator._intl.itemsPerPageLabel="\u0420\u044f\u0434\u043a\u0456\u0432 \u0443 \u0442\u0430\u0431\u043b\u0438\u0446\u0456",this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}getGroups(){this.groupsSubscription=Object(l.a)({groups:this.groupsSertvice.getData("Group"),faculties:this.groupsSertvice.getData("Faculty"),specialities:this.groupsSertvice.getData("Speciality")}).subscribe(t=>{this.specialities=t.specialities,this.faculties=t.faculties;const a=this.genereteTableData(t.groups);this.sharedData.push(this.specialities,this.faculties),this.dataSource=new o.l(a),this.sharedData&&this.groupsSertvice.saveData(this.sharedData),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}),this.loading=!1,this.groupsSertvice.snackBarOpen("\u0413\u0440\u0443\u043f\u0438 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043e")}changeGroup(t){t?this.editGroupModal(t):this.addGroupModal()}delCurrGroup(t){this.dialog.open(u.a,{width:"300px",data:{group_name:t.group_name}}).afterClosed().subscribe(a=>{a?this.delGroup(t.group_id):(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)})}addGroup(t){this.groupsSubscription=this.groupsSertvice.insertData("Group",t).subscribe(t=>{t=Object.assign(Object.assign({},t[0]),{speciality_name:this.getSpecParam(t[0].speciality_id,"speciality_id"),faculty_name:this.getFacParam(t[0].faculty_id,"faculty_id")}),this.dataSource.data=this.dataSource.data.concat(t),this.dataSource.paginator.lastPage(),this.dataSource.sort=this.sort,this.groupsSertvice.snackBarOpen("\u0413\u0440\u0443\u043f\u0443 \u0434\u043e\u0434\u0430\u043d\u043e")},t=>{this.groupsSertvice.snackBarOpen("\u041c\u043e\u0436\u043b\u0438\u0432\u043e \u0442\u0430\u043a\u0430 \u0433\u0440\u0443\u043f\u0430 \u0432\u0436\u0435 \u0456\u0441\u043d\u0443\u0454"),this.loading=!1})}editGroup(t,a){this.groupsSubscription=this.groupsSertvice.updateData("Group",t,a).subscribe(a=>{const e=this.dataSource.data.map(e=>e.group_id===t?Object.assign(Object.assign({},a[0]),{speciality_name:this.getSpecParam(a[0].speciality_id,"speciality_id"),faculty_name:this.getFacParam(a[0].faculty_id,"faculty_id")}):e);this.dataSource.data=e,this.groupsSertvice.snackBarOpen("\u0413\u0440\u0443\u043f\u0443 \u0432\u0456\u0434\u0440\u0435\u0434\u0430\u0433\u043e\u0432\u0430\u043d\u043e")},t=>{this.groupsSertvice.snackBarOpen("\u041c\u043e\u0436\u043b\u0438\u0432\u043e \u0442\u0430\u043a\u0430 \u0433\u0440\u0443\u043f\u0430 \u0432\u0436\u0435 \u0456\u0441\u043d\u0443\u0454")})}getSpecParam(t,a){return"speciality_name"===a?this.specialities.filter(a=>a.speciality_name===t)[0].speciality_id:this.specialities.filter(a=>a.speciality_id===t)[0].speciality_name}getFacParam(t,a){return"faculty_name"===a?this.faculties.filter(a=>a.faculty_name===t)[0].faculty_id:this.faculties.filter(a=>a.faculty_id===t)[0].faculty_name}delGroup(t){this.groupsSubscription=this.groupsSertvice.delData("Group",t).subscribe(()=>{this.dataSource.data=this.dataSource.data.filter(a=>a.group_id!==t),this.groupsSertvice.snackBarOpen("\u0413\u0440\u0443\u043f\u0443 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e"),this.dataSource.data=this.dataSource.data},()=>{this.groupsSertvice.snackBarOpen("\u0421\u043f\u043e\u0447\u0430\u0442\u043a\u0443 \u0432\u0438\u0434\u0430\u043b\u0456\u0442\u044c \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0456\u0432")})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}goToStudents(t,a){this.router.navigate(["admin/group/students/"],{state:{groupName:a,id:t}})}genereteTableData(t){const a=t;return a.map(t=>{this.specialities.map(a=>{t.speciality_id===a.speciality_id&&(t.speciality_name=a.speciality_name)}),this.faculties.map(a=>{t.faculty_id===a.faculty_id&&(t.faculty_name=a.faculty_name)})}),a}editGroupModal(t){this.dialog.open(O,{width:"300px",data:{group_id:t.group_id,group_name:t.group_name,speciality_name:t.speciality_name,faculty_name:t.faculty_name,type:"edit"}}).afterClosed().subscribe(a=>{a&&this.editGroup(t.group_id,{group_name:a.group_name,speciality_id:this.getSpecParam(a.speciality_name,"speciality_name"),faculty_id:this.getFacParam(a.faculty_name,"faculty_name")})})}addGroupModal(){this.dialog.open(O,{width:"300px",data:{type:"add"}}).afterClosed().subscribe(t=>{t&&this.addGroup({group_name:t.group_name,speciality_id:this.getSpecParam(t.speciality_name,"speciality_name"),faculty_id:this.getFacParam(t.faculty_name,"faculty_name")})})}ngOnDestroy(){this.groupsSubscription&&this.groupsSubscription.unsubscribe()}}return t.\u0275fac=function(a){return new(a||t)(m.Ob(g),m.Ob(p.b),m.Ob(i.b))},t.\u0275cmp=m.Ib({type:t,selectors:[["app-groups"]],viewQuery:function(t,a){if(1&t&&(m.Kc(r.a,!0),m.Kc(s.a,!0)),2&t){let t;m.rc(t=m.dc())&&(a.paginator=t.first),m.rc(t=m.dc())&&(a.sort=t.first)}},decls:19,vars:4,consts:[[1,"entity-header"],[1,"mat-h1","entity-title"],[1,"admins-title-icon"],["mat-raised-button","","color","primary",3,"click"],[1,"btn-icon"],[1,"entity-table-filter","filter"],[1,"entity-search-label"],[1,"entity-search-icon"],["matInput","","placeholder","\u0417\u0434\u0456\u0439\u0441\u043d\u044e\u0439\u0442\u0435 \u0444\u0456\u043b\u044c\u0442\u0440\u0430\u0446\u0456\u044e \u043f\u043e \u0432\u0441\u0456\u0445 \u043a\u043e\u043b\u043e\u043d\u043a\u0430\u0445 \u0442\u0430\u0431\u043b\u0438\u0446\u0456",3,"keyup"],["input",""],["class","mat-elevation-z8 entity-table",4,"ngIf","ngIfElse"],["spinner",""],[1,"mat-elevation-z8","entity-table"],["mat-table","","matSort","",3,"dataSource"],["table",""],["matColumnDef","group_id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","group_name"],["matColumnDef","faculty_name"],["matColumnDef","speciality_name"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-flat-button","","color","primary",1,"operation-button",3,"click"],["aria-hidden","false","aria-label","supervisor_account","matTooltip","\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0456\u0432"],["aria-hidden","false","aria-label","edit","matTooltip","\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0433\u0440\u0443\u043f\u0443"],["aria-hidden","false","aria-label","delete","matTooltip","\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0433\u0440\u0443\u043f\u0443"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,a){if(1&t&&(m.Ub(0,"div",0),m.Ub(1,"h1",1),m.Ub(2,"mat-icon",2),m.Fc(3,"groups "),m.Tb(),m.Fc(4,"\u0413\u0440\u0443\u043f\u0438 \u0456 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0438 "),m.Tb(),m.Ub(5,"button",3),m.cc("click",function(){return a.changeGroup()}),m.Ub(6,"mat-icon",4),m.Fc(7,"add_circle"),m.Tb(),m.Fc(8," \u0414\u043e\u0434\u0430\u0442\u0438 \u0433\u0440\u0443\u043f\u0443 "),m.Tb(),m.Tb(),m.Ub(9,"mat-form-field",5),m.Ub(10,"mat-label",6),m.Ub(11,"mat-icon",7),m.Fc(12,"person_search"),m.Tb(),m.Fc(13," \u041f\u043e\u0448\u0443\u043a "),m.Tb(),m.Ub(14,"input",8,9),m.cc("keyup",function(t){return a.applyFilter(t)}),m.Tb(),m.Tb(),m.Dc(16,q,22,5,"div",10),m.Dc(17,Q,1,0,"ng-template",null,11,m.Ec)),2&t){const t=m.sc(18);m.Cb(9),m.Gb("hide",a.loading||!a.dataSource.data.length),m.Cb(7),m.lc("ngIf",!a.loading)("ngIfElse",t)}},directives:[G.a,D.b,_.c,_.g,y.b,c.k,o.k,s.a,o.c,o.e,o.b,o.g,o.j,o.h,r.a,o.d,s.b,o.a,k.a,o.f,o.i,P.a],styles:["table[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:20%}.header-icon[_ngcontent-%COMP%]{vertical-align:top;font-size:45px;margin:-5px 25px auto auto}.operation-button[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;justify-content:center;width:2.2rem;height:2.2rem;min-width:30px;margin:0 .5rem 0 0;padding:0 .4rem}.operation-button[_ngcontent-%COMP%]:last-child{margin:0}.operation-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;font-size:1.2rem}"]}),t})()}];let J=(()=>{class t{}return t.\u0275mod=m.Mb({type:t}),t.\u0275inj=m.Lb({factory:function(a){return new(a||t)},imports:[[c.c,n.a,i.f.forChild(V)]]}),t})()}}]);